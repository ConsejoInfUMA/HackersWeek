{% extends "base.html" %}
{% load staticfiles %}
{% load i18n %}

{% block extra_head %}

{% endblock %}

{% block head_title %} - STAFF Area{% endblock %}

{% block content %}
{% include '_staff_nav.html' with page='home' %}
<div class="container text-center lead" style="min-height:400px;">
<p style="font-size:35px;">ยก{{stats.user_no}} usuario{{ stats.user_no|pluralize }} registrados!</p>
<div class="row">
	<div class="col-sm-6">
		<div class="row">
			<canvas id="fb-vs-nofb" width="300" height="300"/>
		</div>
		<div class="row">
			<p>FB vs no-FB</p>
		</div>
		
	</div> 
	<div class="col-sm-6">
		<div class="row">
			<canvas id="courses" width="300" height="300"/>
		</div>
		<div class="row">
			<p>University enrolment</p>
		</div>
		
	</div>
</div>

<div class="row">
	<div class="col-sm-12">
		<div class="row">
			<canvas id="signups_per_day" width="800" height="400"/>
		</div>
		<div class="row">
			<p>Signups per day</p>
		</div>
	</div>
</div>
</div>

<div class="container">
<h2 class="text-center">Conferences</h2>
<table class="table table-striped">
	<tr>
		<th>Name</th>
		<th>Speaker</th>
		<th>Company</th>
		<th class="text-center">Confirmed</th>
		<th>Enrolments</th>
	</tr>

	{% for conference in conferences %}

	<tr>
		<td>{{ conference.name|truncatewords_html:5}}</td>
		<td>{{ conference.speaker}}</td>
		<td>{{ conference.company}}</td>
		<td class="text-center"><span {% if conference.confirmed %}class="glyphicon glyphicon-ok" style="color:#7CFC00"{%else%}class="glyphicon glyphicon-remove" style="color:red"{%endif%}></td>
		<td class="text-right">{{ conference.users_enrolled.count }}</td>
	</tr>

	{% endfor %}
</table>

<h2 class="text-center">Workshops</h2>
<table class="table table-striped">
	<tr>
		<th>Name</th>
		<th>Speaker</th>
		<th>Company</th>
		<th class="text-center">Confirmed</th>
		<th>Enrolments</th>
	</tr>

	{% for workshop in workshops %}

	<tr>
		<td>{{ workshop.name|truncatewords_html:5}}</td>
		<td>{{ workshop.speaker}}</td>
		<td>{{ workshop.company}}</td>
		<td class="text-center"><span {% if workshop.confirmed %}class="glyphicon glyphicon-ok" style="color:#7CFC00"{%else%}class="glyphicon glyphicon-remove" style="color:red"{%endif%}></td>
		<td class="text-right">{{ workshop.users_enrolled.count }}</td>
	</tr>

	{% endfor %}
</table>

</div>

{% endblock %}

{% block extra_body %}
<script type="text/javascript" src="{% static 'js/Chart.min.js' %}"></script>
<script type="text/javascript">

	var colours = ['#0099CC','#FD971F','#66D9EF','#FFCC00','#0099FF','#A6E22E','#F92672','#FF0066','#8F8FB2','#006600'];
	var highlights = ['#33ADD6','#FDAC4C','#85E1F2','#FFE682','#82CDFF','#B8E858','#FA518E','#FF66A3','#B1B1C9','#4D944D'];
	
  var fb_vs_nofb = [
      {
          value: {{ stats.face_vs_noface.face }},
          color:"#3B5998",
          highlight: "#768BB7",
          label: "Using Facebook"
      },

      {
          value: {{ stats.face_vs_noface.no_face }},
          color:"#DCDCDC",
          highlight: "#EEEEEE",
          label: "W/o Facebook"
      },

  ];

  var courses = [
  		{% for course, value in stats.courses.items %}
  		{
          value: {{value}},
          color: colours[{{forloop.counter0}}],
          highlight: highlights[{{forloop.counter0}}],
          label: "{{course}}"
     	 },
  		{% endfor %}

  ];

  var signups_per_day = {
    labels: [{% for label in stats.signups_per_day.labels %}
    "{{label}}",
    {% endfor %}],
    datasets: [
        {
            label: "Signups",
            fillColor: "rgba(151,187,205,0.2)",
            strokeColor: "rgba(151,187,205,1)",
            pointColor: "rgba(151,187,205,1)",
            pointStrokeColor: "#fff",
            pointHighlightFill: "#fff",
            pointHighlightStroke: "rgba(151,187,205,1)",
            data: [{% for data in stats.signups_per_day.data %}
    		"{{data}}",
    		{% endfor %}]
        },
    ]
	};


  

    window.onload = function(){
        var ctx = document.getElementById("fb-vs-nofb").getContext("2d");
        window.fb_vs_nofb_pie = new Chart(ctx).Pie(fb_vs_nofb);
        
        var ctx = document.getElementById("courses").getContext("2d");
        window.courses_doughnut = new Chart(ctx).Doughnut(courses);

        var ctx = document.getElementById("signups_per_day").getContext("2d");
		window.signups_per_day_chart = new Chart(ctx).Line(signups_per_day);

     };
</script>
{% endblock %}